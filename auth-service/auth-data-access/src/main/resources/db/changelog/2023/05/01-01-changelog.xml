<?xml version="1.0" encoding="UTF-8"?>
<databaseChangeLog
        xmlns="http://www.liquibase.org/xml/ns/dbchangelog"
        xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
        xsi:schemaLocation="http://www.liquibase.org/xml/ns/dbchangelog
                      http://www.liquibase.org/xml/ns/dbchangelog/dbchangelog-4.21.xsd"
        objectQuotingStrategy="QUOTE_ONLY_RESERVED_WORDS">
    <changeSet id="1683834470940-1" author="vugarmammadli">
        <createTable schemaName="auth" tableName="account_role">
            <column name="account_uuid" type="varchar">
                <constraints nullable="false" primaryKey="true" primaryKeyName="pk_account_role"/>
            </column>
            <column name="role_uuid" type="varchar">
                <constraints nullable="false" primaryKey="true" primaryKeyName="pk_account_role"/>
            </column>
        </createTable>
    </changeSet>
    <changeSet id="1683834470940-2" author="vugarmammadli">
        <createTable schemaName="auth" tableName="accounts">
            <column name="uuid" type="varchar">
                <constraints nullable="false" primaryKey="true" primaryKeyName="pk_accounts"/>
            </column>
            <column name="version" type="BIGINT"/>
            <column defaultValue="ON_WAITING" name="process_status" type="varchar(20)">
                <constraints nullable="false"/>
            </column>
            <column defaultValue="ACTIVE" name="data_status" type="varchar(20)">
                <constraints nullable="false"/>
            </column>
            <column name="created_date" type="DATETIME"/>
            <column name="modification_date" type="DATETIME"/>
            <column name="user_entity_uuid" type="varchar"/>
        </createTable>
    </changeSet>
    <changeSet id="1683834470940-3" author="vugarmammadli">
        <createTable schemaName="auth" tableName="authorities">
            <column name="uuid" type="varchar">
                <constraints nullable="false" primaryKey="true" primaryKeyName="pk_authorıtıes"/>
            </column>
            <column name="version" type="BIGINT"/>
            <column defaultValue="ON_WAITING" name="process_status" type="varchar(20)">
                <constraints nullable="false"/>
            </column>
            <column defaultValue="ACTIVE" name="data_status" type="varchar(20)">
                <constraints nullable="false"/>
            </column>
            <column name="created_date" type="DATETIME"/>
            <column name="modification_date" type="DATETIME"/>
            <column name="permission" type="VARCHAR(255)">
                <constraints nullable="false"/>
            </column>
            <column name="description" type="VARCHAR(255)">
                <constraints nullable="false"/>
            </column>
        </createTable>
    </changeSet>
    <changeSet id="1683834470940-4" author="vugarmammadli">
        <createTable schemaName="auth" tableName="passwords">
            <column name="uuid" type="varchar">
                <constraints nullable="false" primaryKey="true" primaryKeyName="pk_passwords"/>
            </column>
            <column name="version" type="BIGINT"/>
            <column defaultValue="ON_WAITING" name="process_status" type="varchar(20)">
                <constraints nullable="false"/>
            </column>
            <column defaultValue="ACTIVE" name="data_status" type="varchar(20)">
                <constraints nullable="false"/>
            </column>
            <column name="created_date" type="DATETIME"/>
            <column name="modification_date" type="DATETIME"/>
            <column name="user_entity_uuid" type="varchar"/>
            <column name="salt" type="VARCHAR(255)">
                <constraints nullable="false"/>
            </column>
            <column name="hash" type="VARCHAR(255)">
                <constraints nullable="false"/>
            </column>
        </createTable>
    </changeSet>
    <changeSet id="1683834470940-5" author="vugarmammadli">
        <createTable schemaName="auth" tableName="role_authority">
            <column name="authority_id" type="varchar">
                <constraints nullable="false" primaryKey="true" primaryKeyName="pk_role_authorıty"/>
            </column>
            <column name="role_id" type="varchar">
                <constraints nullable="false" primaryKey="true" primaryKeyName="pk_role_authorıty"/>
            </column>
        </createTable>
    </changeSet>
    <changeSet id="1683834470940-6" author="vugarmammadli">
        <createTable schemaName="auth" tableName="roles">
            <column name="uuid" type="varchar">
                <constraints nullable="false" primaryKey="true" primaryKeyName="pk_roles"/>
            </column>
            <column name="version" type="BIGINT"/>
            <column defaultValue="ON_WAITING" name="process_status" type="varchar(20)">
                <constraints nullable="false"/>
            </column>
            <column defaultValue="ACTIVE" name="data_status" type="varchar(20)">
                <constraints nullable="false"/>
            </column>
            <column name="created_date" type="DATETIME"/>
            <column name="modification_date" type="DATETIME"/>
            <column name="name" type="VARCHAR(255)"/>
            <column name="description" type="VARCHAR(255)"/>
        </createTable>
    </changeSet>
    <changeSet id="1683834470940-7" author="vugarmammadli">
        <createTable schemaName="auth" tableName="users">
            <column name="uuid" type="varchar">
                <constraints nullable="false" primaryKey="true" primaryKeyName="pk_users"/>
            </column>
            <column name="version" type="BIGINT"/>
            <column defaultValue="ON_WAITING" name="process_status" type="varchar(20)">
                <constraints nullable="false"/>
            </column>
            <column defaultValue="ACTIVE" name="data_status" type="varchar(20)">
                <constraints nullable="false"/>
            </column>
            <column name="created_date" type="DATETIME"/>
            <column name="modification_date" type="DATETIME"/>
            <column name="key" type="UUID">
                <constraints nullable="false"/>
            </column>
            <column name="first_name" type="VARCHAR(255)">
                <constraints nullable="false"/>
            </column>
            <column name="last_name" type="VARCHAR(255)">
                <constraints nullable="false"/>
            </column>
            <column name="username" type="VARCHAR(255)">
                <constraints nullable="false"/>
            </column>
            <column name="password_entity_uuid" type="varchar"/>
            <column name="timezone" type="VARCHAR(255)">
                <constraints nullable="false"/>
            </column>
            <column name="email" type="VARCHAR(255)">
                <constraints nullable="false"/>
            </column>
            <column name="account_uuid" type="varchar"/>
        </createTable>
    </changeSet>
    <changeSet id="1683834470940-8" author="vugarmammadli">
        <addUniqueConstraint columnNames="permission" constraintName="uc_authorıtıes_permıssıon" schemaName="auth"
                             tableName="authorities"/>
    </changeSet>
    <changeSet id="1683834470940-9" author="vugarmammadli">
        <addUniqueConstraint columnNames="email" constraintName="uc_users_emaıl" schemaName="auth" tableName="users"/>
    </changeSet>
    <changeSet id="1683834470940-10" author="vugarmammadli">
        <addUniqueConstraint columnNames="key" constraintName="uc_users_key" schemaName="auth" tableName="users"/>
    </changeSet>
    <changeSet id="1683834470940-11" author="vugarmammadli">
        <addUniqueConstraint columnNames="username" constraintName="uc_users_username" schemaName="auth"
                             tableName="users"/>
    </changeSet>
    <changeSet id="1683834470940-12" author="vugarmammadli">
        <createIndex indexName="idx_userentity_username" schemaName="auth" tableName="users">
            <column name="username"/>
        </createIndex>
    </changeSet>
    <changeSet id="1683834470940-13" author="vugarmammadli">
        <addForeignKeyConstraint baseColumnNames="user_entity_uuid" baseTableName="accounts" baseTableSchemaName="auth"
                                 constraintName="FK_ACCOUNTS_ON_USERENTITY_UUID" referencedColumnNames="uuid"
                                 referencedTableName="users" referencedTableSchemaName="auth"/>
    </changeSet>
    <changeSet id="1683834470940-14" author="vugarmammadli">
        <addForeignKeyConstraint baseColumnNames="user_entity_uuid" baseTableName="passwords" baseTableSchemaName="auth"
                                 constraintName="FK_PASSWORDS_ON_USERENTITY_UUID" referencedColumnNames="uuid"
                                 referencedTableName="users" referencedTableSchemaName="auth"/>
    </changeSet>
    <changeSet id="1683834470940-15" author="vugarmammadli">
        <addForeignKeyConstraint baseColumnNames="account_uuid" baseTableName="users" baseTableSchemaName="auth"
                                 constraintName="FK_USERS_ON_ACCOUNT_UUID" referencedColumnNames="uuid"
                                 referencedTableName="accounts" referencedTableSchemaName="auth"/>
    </changeSet>
    <changeSet id="1683834470940-16" author="vugarmammadli">
        <addForeignKeyConstraint baseColumnNames="password_entity_uuid" baseTableName="users" baseTableSchemaName="auth"
                                 constraintName="FK_USERS_ON_PASSWORDENTITY_UUID" referencedColumnNames="uuid"
                                 referencedTableName="passwords" referencedTableSchemaName="auth"/>
    </changeSet>
    <changeSet id="1683834470940-17" author="vugarmammadli">
        <addForeignKeyConstraint baseColumnNames="account_uuid" baseTableName="account_role" baseTableSchemaName="auth"
                                 constraintName="fk_accrol_on_account_entıty" referencedColumnNames="uuid"
                                 referencedTableName="accounts" referencedTableSchemaName="auth"/>
    </changeSet>
    <changeSet id="1683834470940-18" author="vugarmammadli">
        <addForeignKeyConstraint baseColumnNames="role_uuid" baseTableName="account_role" baseTableSchemaName="auth"
                                 constraintName="fk_accrol_on_role_entıty" referencedColumnNames="uuid"
                                 referencedTableName="roles" referencedTableSchemaName="auth"/>
    </changeSet>
    <changeSet id="1683834470940-19" author="vugarmammadli">
        <addForeignKeyConstraint baseColumnNames="authority_id" baseTableName="role_authority"
                                 baseTableSchemaName="auth" constraintName="fk_rolaut_on_authorıty_entıty"
                                 referencedColumnNames="uuid" referencedTableName="authorities"
                                 referencedTableSchemaName="auth"/>
    </changeSet>
    <changeSet id="1683834470940-20" author="vugarmammadli">
        <addForeignKeyConstraint baseColumnNames="role_id" baseTableName="role_authority" baseTableSchemaName="auth"
                                 constraintName="fk_rolaut_on_role_entıty" referencedColumnNames="uuid"
                                 referencedTableName="roles" referencedTableSchemaName="auth"/>
    </changeSet>

</databaseChangeLog>